/* asNEAT 0.0.4 2014-03-25 */
define("asNEAT/asNEAT",["exports"],function(a){"use strict";var b={};window.AudioContext=window.AudioContext||window.webkitAudioContext||function(){this.supported=!1},b.context=new window.AudioContext,b.nodeTypes=["gainNode","filterNode","delayNode","compressorNode"],a["default"]=b}),define("asNEAT/connection",["exports"],function(a){"use strict";var b=require("asNEAT/utils")["default"],c=(b.log,require("asNEAT/asNEAT")["default"].context),d=function(a){b.extend(this,this.defaultParameters,a),this.gainNode=null,this.id=b.cantorPair(this.inNode.id,this.outNode.id)};d.prototype.defaultParameters={inNode:null,outNode:null,weight:1,enabled:!0,mutationDeltaChance:.8,mutationDelta:{min:-.2,max:.2},randomMutationRange:{min:.1,max:1.5},discreteMutation:!1},d.prototype.clone=function(a,b){var c=a||this.inNode.clone(),e=b||this.outNode.clone();return new d({inNode:c,outNode:e,weight:this.weight,enabled:this.enabled,mutationDeltaChance:this.mutationDeltaChance,mutationDelta:_.clone(this.mutationDelta),randomMutationRange:_.clone(this.randomMutationRange),discreteMutation:this.discreteMutation})},d.prototype.connect=function(){this.enabled&&(this.gainNode=c.createGain(),this.gainNode.gain.value=this.weight,this.inNode.node.connect(this.gainNode),this.gainNode.connect(this.outNode.node))},d.prototype.disable=function(){this.enabled=!1},d.prototype.mutate=function(){b.mutateParameter({obj:this,parameter:"weight",mutationDeltaChance:this.mutationDeltaChance,mutationDelta:this.mutationDelta,randomMutationRange:this.randomMutationRange})},d.prototype.toString=function(){return(this.enabled?"":"*")+"connection("+this.weight.toFixed(2)+")("+this.inNode.id+" --> "+this.outNode.id+")"},a["default"]=d}),define("asNEAT/network",["exports"],function(a){"use strict";var b=require("asNEAT/utils")["default"],c=require("asNEAT/nodes/oscillatorNode")["default"],d=require("asNEAT/nodes/outNode")["default"],e=require("asNEAT/connection")["default"],f=require("asNEAT/asNEAT")["default"].nodeTypes,g=b.log,h=function(a){b.extend(this,this.defaultParameters,a),0===this.nodes.length&&(this.nodes.push(c.random()),this.nodes.push(new d)),0===this.connections.length&&this.connections.push(new e({inNode:this.nodes[0],outNode:this.nodes[1],weight:.1}))};h.prototype.defaultParameters={nodes:[],connections:[],connectionMutationRate:.1,nodeMutationRate:.1},h.prototype.clone=function(){var a=[];_.forEach(this.nodes,function(b){a.push(b.clone())});var b=[];return _.forEach(this.connections,function(c){var d=_.find(a,{id:c.inNode.id}),e=_.find(a,{id:c.outNode.id});b.push(c.clone(d,e))}),new h({nodes:a,connections:b,connectionMutationRate:this.connectionMutationRate,nodeMutationRate:this.nodeMutationRate})},h.prototype.play=function(){return _.forEach(this.nodes,function(a){a.refresh()}),_.forEach(this.connections,function(a){a.connect()}),_.forEach(this.nodes,function(a){a.play&&a.play()}),this},h.prototype.mutate=function(){var a=[{weight:.25,element:this.splitMutation},{weight:.25,element:this.addOscillator},{weight:.25,element:this.mutateConnectionWeights},{weight:.25,element:this.mutateNodeParameters}],c=b.weightedSelection(a);return c.call(this),this},h.prototype.splitMutation=function(){var a=this.getEnabledConnections(),c=a.length,d=b.randomIndexIn(0,c),h=a[d],i=f.length,j=b.randomIndexIn(0,i),k=f[j],l=require("asNEAT/nodes/"+k)["default"],m=l.random(),n=new e({inNode:h.inNode,outNode:m,weight:h.weight}),o=new e({inNode:m,outNode:h.outNode});return h.disable(),this.nodes.push(m),this.connections.push(n),this.connections.push(o),g("splitting conn "+h.toString()+" with "+m.toString()),this},h.prototype.addOscillator=function(){var a=c.random(),b=new e({inNode:a,outNode:this.nodes[1],weight:.5});return this.nodes.push(a),this.connections.push(b),g("adding oscillator "+a.toString()),this},h.prototype.mutateConnectionWeights=function(a){"undefined"==typeof a&&(a=!0);var c=this.connectionMutationRate,d=!1;if(_.forEach(this.connections,function(a){b.random()<=c&&(a.mutate(),d=!0)}),!d&&a){g("forcing weight mutation");var e=b.randomElementIn(this.connections);e.mutate()}return this},h.prototype.mutateNodeParameters=function(a){"undefined"==typeof a&&(a=!0);var c=this.nodeMutationRate,d=!1;if(_.forEach(this.nodes,function(a){b.random()<=c&&(a.mutate(),d=!0)}),!d&&a){g("forcing node mutation");var e=b.randomElementIn(this.nodes);e.mutate()}return this},h.prototype.getEnabledConnections=function(){return _.filter(this.connections,"enabled")},h.prototype.toString=function(){var a="Nodes:<br>";return _.forEach(this.nodes,function(b){a+=b.toString()+"<br>"}),a+="<br>Connections:<br>",_.forEach(this.connections,function(b){a+=b.toString()+"<br>"}),a},a["default"]=h}),define("asNEAT/nodes/compressorNode",["exports"],function(a){"use strict";var b=require("asNEAT/utils")["default"],c=require("asNEAT/nodes/node")["default"],d=require("asNEAT/asNEAT")["default"].context,e=function(a){c.call(this,a)};e.prototype=Object.create(c.prototype),e.prototype.defaultParameters={threshold:0,knee:0,ratio:0,reduction:0,attack:0,release:0,parameterMutationChance:.1,mutatableParameters:[{name:"threshold",mutationDeltaChance:.8,mutationDelta:{min:-5,max:5},randomMutationRange:{min:-50,max:10}},{name:"knee",mutationDeltaChance:.8,mutationDelta:{min:-5,max:5},randomMutationRange:{min:20,max:40}},{name:"ratio",mutationDeltaChance:.8,mutationDelta:{min:-1,max:1},randomMutationRange:{min:8,max:16}},{name:"reduction",mutationDeltaChance:.8,mutationDelta:{min:-1,max:1},randomMutationRange:{min:-10,max:0}},{name:"attack",mutationDeltaChance:.8,mutationDelta:{min:-.02,max:.02},randomMutationRange:{min:0,max:.1}},{name:"release",mutationDeltaChance:.8,mutationDelta:{min:-.1,max:.1},randomMutationRange:{min:0,max:.1}}]},e.prototype.clone=function(){return new e({id:this.id,threshold:this.threshold,knee:this.knee,ratio:this.ratio,reduction:this.reduction,attack:this.attack,release:this.release,parameterMutationChance:this.parameterMutationChance,mutatableParameters:_.cloneDeep(this.mutatableParameters)})},e.prototype.refresh=function(){var a=d.createDynamicsCompressor();a.threshold.value=this.threshold,a.knee.value=this.knee,a.ratio.value=this.ratio,a.reduction.value=this.reduction,a.attack.value=this.attack,a.release.value=this.release,this.node=a},e.prototype.toString=function(){return this.id+": CompressorNode("+this.threshold.toFixed(2)+","+this.knee.toFixed(2)+","+this.ratio.toFixed(2)+","+this.reduction.toFixed(2)+","+this.attack.toFixed(2)+","+this.release.toFixed(2)+")"},e.random=function(){var a=b.randomIn(-50,10),c=b.randomIn(20,40),d=b.randomIn(8,16),f=b.randomIn(-10,0),g=b.randomIn(0,.1),h=b.randomIn(0,.1);return new e({threshold:a,knee:c,ratio:d,reduction:f,attack:g,release:h})},a["default"]=e}),define("asNEAT/nodes/delayNode",["exports"],function(a){"use strict";var b=require("asNEAT/utils")["default"],c=require("asNEAT/nodes/node")["default"],d=require("asNEAT/asNEAT")["default"].context,e=function(a){c.call(this,a)};e.prototype=Object.create(c.prototype),e.prototype.defaultParameters={delayTime:0,feedbackRatio:.2,parameterMutationChance:.1,mutatableParameters:[{name:"delayTime",mutationDeltaChance:.8,mutationDelta:{min:-.5,max:.5},randomMutationRange:{min:0,max:3}},{name:"feedbackRatio",mutationDeltaChance:.8,mutationDelta:{min:-.2,max:.2},randomMutationRange:{min:0,max:.6}}]},e.prototype.clone=function(){return new e({id:this.id,delayTime:this.delayTime,feedbackRatio:this.feedbackRatio,parameterMutationChance:this.parameterMutationChance,mutatableParameters:_.cloneDeep(this.mutatableParameters)})},e.prototype.refresh=function(){var a=d.createDelay();a.delayTime=this.delayTime;var b=d.createGain();b.gain.value=this.feedbackRatio,a.connect(b),b.connect(a),this.node=a},e.prototype.toString=function(){return this.id+": DelayNode("+this.delayTime.toFixed(2)+","+this.feedbackRatio.toFixed(2)+")"},e.random=function(){return new e({delayTime:b.randomIn(0,3),feedbackRatio:b.randomIn(0,.6)})},a["default"]=e}),define("asNEAT/nodes/filterNode",["exports"],function(a){"use strict";var b=require("asNEAT/utils")["default"],c=require("asNEAT/nodes/node")["default"],d=require("asNEAT/asNEAT")["default"].context,e=function(a){c.call(this,a)};e.prototype=Object.create(c.prototype),e.prototype.defaultParameters={type:0,frequency:500,detune:0,q:1,gain:1,parameterMutationChance:.1,mutatableParameters:[{name:"type",mutationDeltaChance:0,randomMutationRange:{min:0,max:8},allowInverse:!1,discreteMutation:!0},{name:"frequency",mutationDeltaChance:.8,mutationDelta:{min:-500,max:500},randomMutationRange:{min:27.5,max:1046.5}}]},e.prototype.clone=function(){return new e({id:this.id,type:this.type,frequency:this.frequency,detune:this.detune,q:this.q,gain:this.gain,parameterMutationChance:this.parameterMutationChance,mutatableParameters:_.cloneDeep(this.mutatableParameters)})},e.prototype.refresh=function(){var a=d.createBiquadFilter();a.type=this.type,a.frequency.value=this.frequency,a.detune.value=this.detune,a.Q.value=this.q,a.gain.value=this.gain,this.node=a},e.prototype.toString=function(){return this.id+": FilterNode("+this.type+","+this.frequency.toFixed(2)+")"},e.TYPES=["lowpass","highpass","bandpass","lowshelf","highshelf","peaking","notch","allpass"],e.random=function(){var a=b.randomIndexIn(0,e.TYPES.length),c=b.randomIn(27.5,1046.5);return new e({type:e.TYPES[a],frequency:c})},a["default"]=e}),define("asNEAT/nodes/gainNode",["exports"],function(a){"use strict";var b=require("asNEAT/utils")["default"],c=require("asNEAT/nodes/node")["default"],d=require("asNEAT/asNEAT")["default"].context,e=function(a){c.call(this,a)};e.prototype=Object.create(c.prototype),e.prototype.defaultParameters={gain:1,parameterMutationChance:.1,mutatableParameters:[{name:"gain",mutationDeltaChance:.8,mutationDelta:{min:-.2,max:.2},randomMutationRange:{min:-1,max:1}}]},e.prototype.clone=function(){return new e({id:this.id,gain:this.gain,parameterMutationChance:this.parameterMutationChance,mutatableParameters:_.cloneDeep(this.mutatableParameters)})},e.prototype.refresh=function(){var a=d.createGain();a.gain.value=this.gain,this.node=a},e.prototype.toString=function(){return this.id+": GainNode("+this.gain.toFixed(2)+")"},e.random=function(){var a=b.randomBool(),c=b.randomIn(.5,1.5);return c*=a?-1:1,new e({gain:c})},a["default"]=e}),define("asNEAT/nodes/node",["exports"],function(a){"use strict";var b=require("asNEAT/utils")["default"],c=function(a){b.extend(this,this.defaultParameters,a),this.id=a&&"undefined"!=typeof a.id?a.id:c.getNextId()};c.prototype.defaultParameters={parameterMutationChance:.1,mutatableParameters:[]},c.prototype.clone=function(){throw"clone not implemented"},c.prototype.refresh=function(){throw"refresh not implemented"},c.prototype.toString=function(){throw"toString not implemented"},c.prototype.mutate=function(){function a(a){b.mutateParameter({obj:c,parameter:a.name,mutationDeltaChance:a.mutationDeltaChance,mutationDelta:a.mutationDelta,randomMutationRange:a.randomMutationRange,allowInverse:a.allowInverse,discreteMutation:a.discreteMutation})}var c=this,d=this.parameterMutationChance,e=this.mutatableParameters,f=!1;if(!e||0===e.length)return void b.log("no mutation parameters");if(_.forEach(this.mutatableParameters,function(c){return b.randomChance(d)?(a(c),void(f=!0)):!0}),!f){var g=b.randomElementIn(e);a(g)}},c.id=0,c.getNextId=function(){return c.id++},c.random=function(){throw"static random not implemented"},a["default"]=c}),define("asNEAT/nodes/oscillatorNode",["exports"],function(a){"use strict";var b=require("asNEAT/utils")["default"],c=require("asNEAT/nodes/node")["default"],d=require("asNEAT/asNEAT")["default"].context,e=27.5,f=1046.5,g=function(a){c.call(this,a)};g.prototype=Object.create(c.prototype),g.prototype.defaultParameters={type:0,frequency:1e3,detune:0,parameterMutationChance:.1,mutatableParameters:[{name:"type",mutationDeltaChance:0,randomMutationRange:{min:0,max:4},allowInverse:!1,discreteMutation:!0},{name:"frequency",mutationDeltaChance:.8,mutationDelta:{min:-500,max:500},randomMutationRange:{min:e,max:f}}]},g.prototype.clone=function(){return new g({id:this.id,type:this.type,frequency:this.frequency,detune:this.detune,parameterMutationChance:this.parameterMutationChance,mutatableParameters:_.cloneDeep(this.mutatableParameters)})},g.prototype.refresh=function(){var a=d.createOscillator();a.type=this.type,a.frequency.value=this.frequency,this.node=a},g.prototype.play=function(){var a=this.node;a.start(0),setTimeout(function(){a.stop(0)},500)},g.prototype.toString=function(){return this.id+": OscillatorNode("+this.type+","+this.frequency.toFixed(2)+")"},g.TYPES=["sine","square","sawtooth","triangle"],g.random=function(){var a=b.randomIndexIn(0,g.TYPES.length),c=b.randomIn(e,f);return new g({type:g.TYPES[a],frequency:c})},a["default"]=g}),define("asNEAT/nodes/outNode",["exports"],function(a){"use strict";var b=require("asNEAT/nodes/node")["default"],c=require("asNEAT/asNEAT")["default"].context,d=function(a){b.call(this,a),this.node=c.destination};d.prototype=Object.create(b.prototype),d.prototype.defaultParameters={},d.prototype.clone=function(){return new d({id:this.id})},d.prototype.refresh=function(){},d.prototype.toString=function(){return this.id+": OutNode"},a["default"]=d}),define("asNEAT/nodes/pannerNode",["exports"],function(a){"use strict";var b=require("asNEAT/utils")["default"],c=require("asNEAT/nodes/node")["default"],d=require("asNEAT/asNEAT")["default"].context,e=function(a){c.call(this,a)};e.prototype=Object.create(c.prototype),e.prototype.defaultParameters={x:0,y:0,z:0,parameterMutationChance:.1,mutatableParameters:[{name:"x",mutationDeltaChance:.8,mutationDelta:{min:-5,max:5},randomMutationRange:{min:-5,max:5}},{name:"y",mutationDeltaChance:.8,mutationDelta:{min:-5,max:5},randomMutationRange:{min:-5,max:5}},{name:"z",mutationDeltaChance:.8,mutationDelta:{min:-5,max:5},randomMutationRange:{min:-5,max:5}}]},e.prototype.clone=function(){return new e({id:this.id,x:this.x,y:this.y,z:this.z,parameterMutationChance:this.parameterMutationChance,mutatableParameters:_.cloneDeep(this.mutatableParameters)})},e.prototype.refresh=function(){var a=d.createPanner();a.setPosition(this.x,this.y,this.z),this.node=a},e.prototype.toString=function(){return this.id+": PannerNode("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.z.toFixed(2)+")"},e.random=function(){var a=b.randomIn(-5,5),c=b.randomIn(-5,5),d=b.randomIn(-5,5);return new e({x:a,y:c,z:d})},a["default"]=e}),define("asNEAT/utils",["exports"],function(a){"use strict";var b={};b.IS_DEBUG=!0,b.log=function(a){b.IS_DEBUG&&(console.log(a),$&&$(".log").prepend("<div>"+a+"</div>"))},b.error=function(a){throw a},b.random=function(){return Math.random()},b.randomIn=function(a,b){return _.isObject(a)&&(b=a.max,a=a.min),Math.random()*(b-a)+a},b.randomIndexIn=function(a,c){return _.isObject(a)&&(c=a.max,a=a.min),Math.floor(b.randomIn(a,c))},b.randomChance=function(a){return b.random()<=a},b.randomBool=function(){return!!Math.round(Math.random())},b.randomElementIn=function(a){if(0!==a.length){var c=b.randomIndexIn(0,a.length);return a[c]}},b.clamp=function(a,b,c){return a>c?c:b>a?b:a},b.shuffle=function(a){for(var b,c,d=a.length;d;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a},b.weightedSelection=function(a){var b,c=Math.random(),d=0;return _.forEach(a,function(a){return d+=a.weight,d>=c?(b=a.element,!1):void 0}),b},b.mutateParameter=function(a){_.defaults(a,{obj:null,parameter:"param",mutationDeltaChance:.8,mutationDelta:{min:-.2,max:.2},randomMutationRange:{min:.1,max:1.5},allowInverse:!0,discreteMutation:!1}),b.log("mutating("+a.parameter+") "+a.obj);var c,d,e;b.randomChance(a.mutationDeltaChance)?(c=a.discreteMutation?b.randomIndexIn(a.mutationDelta):b.randomIn(a.mutationDelta),b.log("mutating by delta "+c.toFixed(3)),a.obj[a.parameter]+=c):(d=a.randomMutationRange,e=a.discreteMutation?b.randomIndexIn(d):b.randomIn(d),a.allowInverse&&b.randomBool()&&(e*=-1),b.log("mutating with new param "+e),a.obj[a.parameter]=e)},b.cantorPair=function(a,b){return(a+b)*(a+b+1)/2+b},b.reverseCantorPair=function(a){var b=Math.floor((-1+Math.sqrt(1+8*a))/2),c=b*(b+3)/2-a,d=a-b*(b+1)/2;return{x:c,y:d}},b.extend=function(a,b,c){_.assign(a,_.cloneDeep(b),c)},a["default"]=b});